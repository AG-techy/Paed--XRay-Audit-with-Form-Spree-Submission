<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Paediatric X-ray Teaching Audit – Dr Alakananda Ghosh</title>
  <meta name="description" content="Audit questionnaire for Paediatric X-ray teaching (Upper Limb, Lower Limb, Normal Variants, Safeguarding).">
  <style>
    :root { --accent:#0b74de; --muted:#f5f7fb; --text:#1a1a1a; --border:#e6e9ef; }
    * { box-sizing: border-box; }
    body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin:0; color:var(--text); background:#fff; }
    header { padding: 28px 20px; background: linear-gradient(180deg, var(--muted), #fff); border-bottom:1px solid var(--border); }
    .container { max-width: 980px; margin: 0 auto; padding: 0 20px; }
    h1 { margin:0 0 8px; font-size: 28px; }
    .sub { color:#5b6577; margin:0; }
    section { margin: 28px 0; padding: 20px; border:1px solid var(--border); border-radius:14px; }
    h2 { margin:0 0 12px; font-size: 20px; }
    .grid { display:grid; gap:12px; }
    label { font-weight: 600; }
    .row { display:flex; flex-wrap: wrap; gap: 10px 18px; align-items:center; }
    .chip { display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border:1px solid var(--border); border-radius:999px; cursor:pointer; background:#fff; }
    .chip input { accent-color: var(--accent); }
    .help { color:#6b7280; font-size:13px; margin-top:8px; }
    textarea, input[type="text"] { width:100%; padding:12px 14px; border:1px solid var(--border); border-radius:10px; font-size:14px; }
    .scale { border:1px dashed var(--border); border-radius:12px; padding:10px; }
    .scale-row { display:flex; gap:10px; align-items:center; justify-content:space-between; padding:8px 6px; border-bottom:1px solid #f0f2f7; }
    .scale-row:last-child { border-bottom:none; }
    .scale-title { flex: 1 1 auto; font-size:14px; }
    .scale-options { display:flex; gap:10px; }
    .scale-options label { font-weight:500; color:#374151; }
    .pill { font-size:12px; padding:3px 8px; background:var(--muted); border:1px solid var(--border); border-radius:999px; }
    .actions { display:flex; flex-wrap:wrap; gap:10px; margin-top:16px; }
    button { appearance:none; border:none; background:var(--accent); color:#fff; padding:12px 16px; border-radius:12px; cursor:pointer; font-weight:700; }
    button.secondary { background:#fff; color:#0f172a; border:1px solid var(--border); }
    .footer { color:#6b7280; font-size:12px; text-align:center; padding:20px 0 40px; }
    .tag { background:#eaf3ff; color:#0b74de; border:1px solid #cfe2ff; padding:2px 6px; border-radius:999px; font-size:12px; }
    .qrblock { display:flex; gap:14px; align-items:center; margin-top:8px; }
    .qrcanvas { width:140px; height:140px; border:1px solid var(--border); border-radius:10px; }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>Paediatric X-ray Teaching Audit</h1>
      <p class="sub">Facilitator: <strong>Dr Alakananda Ghosh</strong> &middot; Series: Upper Limb &middot; Lower Limb &middot; Normal Variants &middot; Safeguarding</p>
    </div>
  </header>

  <main class="container">
    <form method="POST" action="https://formspree.io/f/xpwoqrdz">

      <section>
        <h2>Participant Details</h2>
        <div class="grid">
          <div>
            <label>Role</label>
            <div class="row">
              <label class="chip"><input type="radio" name="role" value="ENP" required> ENP</label>
              <label class="chip"><input type="radio" name="role" value="Junior Doctor" required> Junior Doctor</label>
              <label class="chip"><input type="radio" name="role" value="Nurse" required> Nurse</label>
              <label class="chip"><input type="radio" name="role" value="Other" required> Other</label>
            </div>
          </div>
          <div>
            <label>Session attended <span class="pill">select all that apply</span></label>
            <div class="row">
              <label class="chip"><input type="checkbox" name="session[]" value="Upper Limb"> Upper Limb</label>
              <label class="chip"><input type="checkbox" name="session[]" value="Lower Limb"> Lower Limb</label>
              <label class="chip"><input type="checkbox" name="session[]" value="Normal Variants"> Normal Variants</label>
              <label class="chip"><input type="checkbox" name="session[]" value="Safeguarding"> Safeguarding</label>
            </div>
          </div>
        </div>
        <p class="help">All responses are anonymous and for teaching quality improvement.</p>
      </section>

      <section>
        <h2>Pre-Session Self-Assessment <span class="pill">1=Not confident &middot; 5=Very confident</span></h2>
        <div id="pre" class="scale"></div>
      </section>

      <section>
        <h2>Post-Session Self-Assessment <span class="pill">1=Not confident &middot; 5=Very confident</span></h2>
        <div id="post" class="scale"></div>
      </section>

      <section>
        <h2>Session Feedback <span class="pill">1=Strongly disagree &middot; 5=Strongly agree</span></h2>
        <div id="fb" class="scale"></div>
      </section>

      <section>
        <h2>Free-Text Feedback</h2>
        <div class="grid">
          <div>
            <label>What part of the teaching helped you most?</label>
            <textarea name="best" rows="3" placeholder="Your answer"></textarea>
          </div>
          <div>
            <label>What could be improved for future sessions?</label>
            <textarea name="improve" rows="3" placeholder="Your answer"></textarea>
          </div>
          <div>
            <label>Any additional feedback or suggestions</label>
            <textarea name="other" rows="3" placeholder="Your answer"></textarea>
          </div>
        </div>
      </section>

      <section>
        <h2>Submit</h2>
        <div class="actions">
          <button type="submit">Submit response</button>
          <button class="secondary" type="reset">Reset form</button>
        </div>
        <p class="help">Your response will be collected via Formspree. You can download all data from your Formspree dashboard.</p>
      </section>

    </form>
    
    <section>
      <h2>QR Code</h2>
      <div class="qrblock">
        <canvas id="qr" class="qrcanvas" aria-label="QR code"></canvas>
        <div>
          <div>Scan to open: <code id="qrLink">https://ag-techy.github.io/paed-xray-audit/</code></div>
          <p class="help">This QR points to the live hosted page.</p>
        </div>
      </div>
    </section>

    <p class="footer">© <span id="year"></span> Dr Alakananda Ghosh · Paediatric X-ray Teaching Audit</p>
  </main>

  <script>
    // Configuration
    // **FIXED URL**
    const SURVEY_URL = "https://ag-techy.github.io/paed-xray-audit/"; 
    const preItems = [
      "Identifying normal paediatric X-ray anatomy",
      "Recognising common fractures and injury patterns",
      "Distinguishing normal variants from pathology",
      "Correlating X-ray findings with safeguarding concerns",
      "Interpreting images independently in the ED setting"
    ];
    const postItems = [...preItems];
    const fbItems = [
      "The session was clear and easy to follow",
      "The PowerPoint visuals were useful for learning",
      "The content was appropriate for my role",
      "The session improved my safeguarding awareness",
      "The teaching was interactive and engaging",
      "I can apply what I learned to clinical practice",
      "I would recommend this session to colleagues"
    ];

    const qs = (sel, root=document) => root.querySelector(sel);

    function buildScale(root, groupName, items, min=1, max=5) {
      items.forEach((text, idx) => {
        const row = document.createElement('div');
        row.className = 'scale-row';
        const title = document.createElement('div');
        title.className = 'scale-title';
        title.textContent = text;
        const opts = document.createElement('div');
        opts.className = 'scale-options';
        for (let v=min; v<=max; v++) {
          const id = `${groupName}_${idx}_${v}`;
          const lab = document.createElement('label');
          // Use the input's name attribute to pass scale data
          lab.innerHTML = `<input type="radio" name="${groupName}_${idx}" value="${v}" required> ${v}`; 
          opts.appendChild(lab);
        }
        row.appendChild(title);
        row.appendChild(opts);
        root.appendChild(row);
      });
    }

    // This is now a simplified function just for a basic reset
    function resetForm() {
      document.querySelector('form').reset();
    }

    function drawSimpleQR(canvas, text) {
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = '#fff'; ctx.fillRect(0,0,canvas.width,canvas.height);
      // Fallback text-in-box if CDN QR lib blocked
      ctx.fillStyle = '#000'; ctx.font = '12px sans-serif';
      const lines = text.match(/.{1,16}/g) || [text];
      lines.forEach((ln,i)=>ctx.fillText(ln, 6, 20 + i*14));
      ctx.strokeStyle = '#c9d1e6'; ctx.strokeRect(0.5,0.5,canvas.width-1,canvas.height-1);
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Build scales
      buildScale(qs('#pre'), 'pre', preItems);
      buildScale(qs('#post'), 'post', postItems);
      buildScale(qs('#fb'), 'fb', fbItems);

      // Wire button (only reset remains)
      document.querySelector('button[type="reset"]').addEventListener('click', resetForm);

      // QR
      document.getElementById('qrLink').textContent = SURVEY_URL;
      const canvas = document.getElementById('qr');
      drawSimpleQR(canvas, SURVEY_URL);

      // Year
      document.getElementById('year').textContent = new Date().getFullYear();
    });
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js" defer></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      if (window.QRious) {
        // **FIXED QR VALUE**
        new QRious({ element: document.getElementById('qr'), value: SURVEY_URL, size: 140 }); 
      }
    });
  </script>
</body>
</html>
